{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Parameters for RoI Cluster Fusion Node",
  "type": "object",
  "definitions": {
    "roi_cluster_fusion": {
      "type": "object",
      "properties": {
        "fusion_distance": {
          "type": "number",
          "description": "If the detected object's distance is less than its value, the fusion will be processed.",
          "default": 100.0,
          "minimum": 0.0
        },
        "strict_iou_fusion_distance": {
          "type": "number",
          "description": "If the detected object's distance is less than its value, IoU method specified in `strict_iou_match_mode` is used, otherwise `rough_iou_match_mode` is used.",
          "default": 100.0,
          "minimum": 0.0
        },
        "strict_iou_match_mode": {
          "type": "string",
          "description": "Name of IoU method applied to the objects in range of [0.0, `trust_distance`].",
          "default": "iou",
          "enum": ["iou", "iou_x", "iou_y"]
        },
        "rough_iou_match_mode": {
          "type": "string",
          "description": "Name of IoU method applied to the objects in range of [`trust_distance`, `fusion_distance`], if `trust_distance` < `fusion_distance`.",
          "default": "iou_x",
          "enum": ["iou", "iou_x", "iou_y"]
        },
        "use_cluster_semantic_type": {
          "type": "boolean",
          "description": "If this parameter is false, label of cluster objects will be reset to UNKNOWN.",
          "default": false
        },
        "only_allow_inside_cluster": {
          "type": "boolean",
          "description": "If this parameter is true, only clusters in which all their points are inside the RoI can be assigned to the RoI.",
          "default": true
        },
        "roi_scale_factor": {
          "type": "number",
          "description": "A scale factor for resizing RoI while checking if cluster points are inside the RoI.",
          "default": 1.1,
          "minimum": 1.0,
          "maximum": 2.0
        },
        "iou_threshold": {
          "type": "object",
          "description": "IoU score thresholds for each object class.",
          "properties": {
            "UNKNOWN": {
              "type": "number",
              "description": "IoU threshold for UNKNOWN objects.",
              "default": 0.1,
              "minimum": 0.0,
              "maximum": 1.0
            },
            "CAR": {
              "type": "number",
              "description": "IoU threshold for CAR objects.",
              "default": 0.65,
              "minimum": 0.0,
              "maximum": 1.0
            },
            "TRUCK": {
              "type": "number",
              "description": "IoU threshold for TRUCK objects.",
              "default": 0.65,
              "minimum": 0.0,
              "maximum": 1.0
            },
            "BUS": {
              "type": "number",
              "description": "IoU threshold for BUS objects.",
              "default": 0.65,
              "minimum": 0.0,
              "maximum": 1.0
            },
            "TRAILER": {
              "type": "number",
              "description": "IoU threshold for TRAILER objects.",
              "default": 0.65,
              "minimum": 0.0,
              "maximum": 1.0
            },
            "MOTORCYCLE": {
              "type": "number",
              "description": "IoU threshold for MOTORCYCLE objects.",
              "default": 0.65,
              "minimum": 0.0,
              "maximum": 1.0
            },
            "BICYCLE": {
              "type": "number",
              "description": "IoU threshold for BICYCLE objects.",
              "default": 0.65,
              "minimum": 0.0,
              "maximum": 1.0
            },
            "PEDESTRIAN": {
              "type": "number",
              "description": "IoU threshold for PEDESTRIAN objects.",
              "default": 0.65,
              "minimum": 0.0,
              "maximum": 1.0
            }
          },
          "required": [
            "UNKNOWN",
            "CAR",
            "TRUCK",
            "BUS",
            "TRAILER",
            "MOTORCYCLE",
            "BICYCLE",
            "PEDESTRIAN"
          ]
        },
        "remove_unknown": {
          "type": "boolean",
          "description": "If this parameter is true, all of objects labeled UNKNOWN will be removed in post-process.",
          "default": false
        }
      },
      "required": [
        "fusion_distance",
        "strict_iou_fusion_distance",
        "strict_iou_match_mode",
        "rough_iou_match_mode",
        "use_cluster_semantic_type",
        "only_allow_inside_cluster",
        "roi_scale_factor",
        "iou_threshold",
        "remove_unknown"
      ]
    }
  },
  "properties": {
    "/**": {
      "type": "object",
      "properties": {
        "ros__parameters": {
          "$ref": "#/definitions/roi_cluster_fusion"
        }
      },
      "required": ["ros__parameters"]
    }
  },
  "required": ["/**"]
}
